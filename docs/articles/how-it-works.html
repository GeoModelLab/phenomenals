<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>How it works ‚Ä¢ phenomenals</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="‚Äùimage/svg+xml‚Äù" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="How it works">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-primary" data-bs-theme="dark" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">phenomenals</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>How it works</h1>
            
      

      <div class="d-none name"><code>how-it-works.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="how-it-works">How it works<a class="anchor" aria-label="anchor" href="#how-it-works"></a>
</h2>
<p>PhenoMeNals integrates eco-physiological signals across the grapevine
phenological cycle to predict yield and quality traits. This section
explains the underlying biological logic and modeling steps.</p>
<blockquote>
<p>üß† Recommended for advanced users and researchers interested in model
structure and ecophysiological logic.</p>
</blockquote>
<p>Grapevine phenology is a cornerstone of yield and quality prediction,
as environmental conditions across two growing seasons influence
reproductive development. Traditional forecasting models often focus on
single seasons or fixed time windows, overlooking these cumulative
effects.</p>
<p><strong>PhenoMeNals</strong> addresses this gap with a
<strong>phenology-aware framework</strong> that integrates:</p>
<ul>
<li>üå± <strong>Phenology simulation</strong> using BBCH observations and
weather data<br>
</li>
<li>üå°Ô∏è <strong>Eco-physiological functions</strong> capturing
temperature, radiation, water balance, and stress signals<br>
</li>
<li>üìä <strong>Statistical modeling</strong> of cumulative environmental
effects (<em>memory signals</em>) on yield and quality</li>
</ul>
<p>Validated across <strong>multi-site, multi-variety datasets</strong>,
PhenoMeNals consistently achieved <strong>R¬≤ &gt; 0.8</strong> for
yield, yield components, and quality traits.</p>
<p>üìÑ <strong>See the full description of PhenoMeNals in the
paper</strong>:<br><em>The PhenoMeNals framework for grapevine yield and quality
prediction</em> (Bregaglio &amp; Bajocco, 2025)</p>
<figure><p align="center">
<img src="images/phenomenals_schema.png" width="550"></p>
<figcaption align="center"><em>Figure 1. Overview of the PhenoMeNals workflow. The pipeline
integrates BBCH observations and weather data to calibrate a
phenological model reproducing the grapevine cycle across two seasons
(Year -1 and Year 0). Eco-physiological functions are computed along
this timeline and aggregated within phenological bins. Each signal is
evaluated for its correlation with the target trait and normalized via
sigmoid transformation. The resulting cumulative memory signals
(PhenoMeNals) serve as predictors for Leave One Out Cross Validation
(LOOCV) using multiple linear regression. Outputs include regression
coefficients, variable importance and model diagnostics.</em>
</figcaption></figure><p>PhenoMeNals organizes its workflow along the full <strong>two-season
grapevine cycle</strong>:</p>
<div class="section level3">
<h3 id="year--1-dormancy-and-pre-harvest-season">Year -1: Dormancy and Pre-Harvest Season<a class="anchor" aria-label="anchor" href="#year--1-dormancy-and-pre-harvest-season"></a>
</h3>
<ul>
<li>‚ùÑÔ∏è Chilling accumulation and dormancy release<br>
</li>
<li>üå∏ Early reproductive development (primordia differentiation and
setup)</li>
</ul>
</div>
<div class="section level3">
<h3 id="year-0-harvest-season">Year 0: Harvest Season<a class="anchor" aria-label="anchor" href="#year-0-harvest-season"></a>
</h3>
<ul>
<li>üåø Budburst, flowering, fruit set and ripening<br>
</li>
<li>üìà Environmental memory effects captured via cumulative
eco-physiological signals</li>
</ul>
</div>
<div class="section level3">
<h3 id="environmental-memory-signals">Environmental Memory Signals<a class="anchor" aria-label="anchor" href="#environmental-memory-signals"></a>
</h3>
<p>Eco-physiological functions (e.g., temperature suitability, drought
stress, radiation limitation) are: 1. üîÑ Smoothed and aligned with
phenological phases<br>
2. ‚öñÔ∏è Normalized and weighted by their correlation with the target
trait<br>
3. ‚ûï Summed into <strong>PhenoMeNals</strong> ‚Äî cumulative indicators
that drive the final prediction</p>
<hr>
</div>
<div class="section level3">
<h3 id="eco-physiological-functions">1. Eco-physiological Functions<a class="anchor" aria-label="anchor" href="#eco-physiological-functions"></a>
</h3>
<p>Eight eco-physiological functions are computed along a standardized
phenological timeline. These functions translate weather variables into
biologically meaningful indices, normalized between 0 (inhibitory) and 1
(optimal). Each function is parameterized using literature values, with
uncertainty bands representing inter-study variation.</p>
<table class="table">
<colgroup>
<col width="11%">
<col width="88%">
</colgroup>
<thead><tr class="header">
<th>Function</th>
<th>Description</th>
</tr></thead>
<tbody>
<tr class="odd">
<td><code>TempF</code></td>
<td>Temperature suitability for growth (nonlinear response with Tmin,
Topt, Tmax)</td>
</tr>
<tr class="even">
<td><code>ColdF</code></td>
<td>Cold stress response, sigmoidal decay below Tcold</td>
</tr>
<tr class="odd">
<td><code>HeatF</code></td>
<td>Heat stress response, sigmoidal decay above Theat</td>
</tr>
<tr class="even">
<td><code>LightF</code></td>
<td>Radiation limitation, exponential saturation above Lmax
(PAR-based)</td>
</tr>
<tr class="odd">
<td><code>VPDeF</code></td>
<td>Vapor pressure deficit limitation, sigmoidal decay between VPDmin
and VPDmax</td>
</tr>
<tr class="even">
<td><code>DroughtF</code></td>
<td>Water stress indicator based on transpiration vs.¬†precipitation</td>
</tr>
<tr class="odd">
<td><code>WindF</code></td>
<td>Wind-induced stress, exponential decline beyond Wmin</td>
</tr>
<tr class="even">
<td><code>DiseaseF</code></td>
<td>Disease favorability (P. viticola) based on temperature and wetness
duration</td>
</tr>
</tbody>
</table>
<p>All functions are calculated hourly, aggregated daily, and
normalized. They serve as potential predictors for downstream modeling.
See the figure below</p>
<figure><p align="center">
<img src="images/phenomenals_functions.png" width="700"></p>
<figcaption align="center"><em>Photoperiodic unit for dormancy induction. The shades correspond to
the 40-60<sup>th</sup> and 25-75<sup>th</sup> percentiles of the
distribution generated with limiting photoperiod ranging from 12 to 14.5
hours and non limiting photoperiod from 11.5 to 13 hours.</em>
</figcaption></figure><div class="section level4">
<h4 id="equations">Equations<a class="anchor" aria-label="anchor" href="#equations"></a>
</h4>
<div class="section level5">
<h5 id="temperature-suitability-for-growth-tempf">üå°Ô∏è Temperature Suitability for Growth (TempF)<a class="anchor" aria-label="anchor" href="#temperature-suitability-for-growth-tempf"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">TempF</mtext><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>T</mi><mo>&lt;</mo><msub><mi>T</mi><mtext mathvariant="normal">min</mtext></msub><mrow><mspace width="0.333em"></mspace><mtext mathvariant="normal"> or </mtext><mspace width="0.333em"></mspace></mrow><mi>T</mi><mo>&gt;</mo><msub><mi>T</mi><mtext mathvariant="normal">max</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>T</mi><mtext mathvariant="normal">max</mtext></msub><mo>‚àí</mo><mi>T</mi></mrow><mrow><msub><mi>T</mi><mtext mathvariant="normal">max</mtext></msub><mo>‚àí</mo><msub><mi>T</mi><mtext mathvariant="normal">opt</mtext></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><msup><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>T</mi><mo>‚àí</mo><msub><mi>T</mi><mtext mathvariant="normal">min</mtext></msub></mrow><mrow><msub><mi>T</mi><mtext mathvariant="normal">opt</mtext></msub><mo>‚àí</mo><msub><mi>T</mi><mtext mathvariant="normal">min</mtext></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><msub><mi>T</mi><mtext mathvariant="normal">opt</mtext></msub><mo>‚àí</mo><msub><mi>T</mi><mtext mathvariant="normal">min</mtext></msub></mrow><mrow><msub><mi>T</mi><mtext mathvariant="normal">max</mtext></msub><mo>‚àí</mo><msub><mi>T</mi><mtext mathvariant="normal">opt</mtext></msub></mrow></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></msup></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{TempF} =
\begin{cases}
0 &amp; \text{if } T &lt; T_{\text{min}} \text{ or } T &gt; T_{\text{max}} \\
\left( \frac{T_{\text{max}} - T}{T_{\text{max}} - T_{\text{opt}}} \right)
\cdot
\left( \frac{T - T_{\text{min}}}{T_{\text{opt}} - T_{\text{min}}} \right)^ {
\left( \frac{T_{\text{opt}} - T_{\text{min}}}{T_{\text{max}} - T_{\text{opt}}} \right)} &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>This equation simulates the nonlinear temperature response for plant
growth using cardinal temperatures: minimum (Tmin), optimum (Topt), and
maximum (Tmax). Growth rate peaks at Topt and is zero outside the
Tmin‚ÄìTmax range.</p>
<hr>
</div>
<div class="section level5">
<h5 id="cold-stress-response-coldf">ü•∂ Cold Stress Response (ColdF)<a class="anchor" aria-label="anchor" href="#cold-stress-response-coldf"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">ColdF</mtext><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>T</mi><mo>&gt;</mo><msub><mi>T</mi><mtext mathvariant="normal">min</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>T</mi><mo>&lt;</mo><msub><mi>T</mi><mtext mathvariant="normal">cold</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mrow><mi>‚àí</mi><mn>10</mn></mrow><mrow><mo stretchy="true" form="prefix">|</mo><msub><mi>T</mi><mtext mathvariant="normal">min</mtext></msub><mo>‚àí</mo><msub><mi>T</mi><mtext mathvariant="normal">cold</mtext></msub><mo stretchy="true" form="postfix">|</mo></mrow></mfrac><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>‚àí</mo><mfrac><mrow><msub><mi>T</mi><mtext mathvariant="normal">min</mtext></msub><mo>+</mo><msub><mi>T</mi><mtext mathvariant="normal">cold</mtext></msub></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{ColdF} =
\begin{cases}
1 &amp; \text{if } T &gt; T_{\text{min}} \\
0 &amp; \text{if } T &lt; T_{\text{cold}} \\
\frac{1}{1 + \exp\left(\frac{-10}{|T_{\text{min}} - T_{\text{cold}}|} \cdot (T - \frac{T_{\text{min}} + T_{\text{cold}}}{2}) \right)} &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>This sigmoid function models the decline in physiological activity as
temperature drops below Tmin, reaching zero at a critical cold threshold
Tcold.</p>
<hr>
</div>
<div class="section level5">
<h5 id="heat-stress-response-heatf">üî• Heat Stress Response (HeatF)<a class="anchor" aria-label="anchor" href="#heat-stress-response-heatf"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">HeatF</mtext><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>T</mi><mo>&lt;</mo><msub><mi>T</mi><mtext mathvariant="normal">max</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>T</mi><mo>&gt;</mo><msub><mi>T</mi><mtext mathvariant="normal">heat</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mfrac><mn>10</mn><mrow><msub><mi>T</mi><mtext mathvariant="normal">max</mtext></msub><mo>‚àí</mo><msub><mi>T</mi><mtext mathvariant="normal">heat</mtext></msub></mrow></mfrac><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo>‚àí</mo><mfrac><mrow><msub><mi>T</mi><mtext mathvariant="normal">max</mtext></msub><mo>+</mo><msub><mi>T</mi><mtext mathvariant="normal">heat</mtext></msub></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{HeatF} =
\begin{cases}
1 &amp; \text{if } T &lt; T_{\text{max}} \\
0 &amp; \text{if } T &gt; T_{\text{heat}} \\
\frac{1}{1 + \exp\left(\frac{10}{T_{\text{max}} - T_{\text{heat}}} \cdot (T - \frac{T_{\text{max}} + T_{\text{heat}}}{2}) \right)} &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>This sigmoid function simulates the impact of extreme heat. The
response decreases past Tmax and approaches zero as T approaches
Theat.</p>
<hr>
</div>
<div class="section level5">
<h5 id="light-limitation-lightf">‚òÄÔ∏è Light Limitation (LightF)<a class="anchor" aria-label="anchor" href="#light-limitation-lightf"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">LightF</mtext><mo>=</mo><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msub><mi>k</mi><mtext mathvariant="normal">light</mtext></msub><mo>‚ãÖ</mo><mfrac><mtext mathvariant="normal">PAR</mtext><msub><mi>L</mi><mtext mathvariant="normal">max</mtext></msub></mfrac><mo stretchy="true" form="postfix">)</mo></mrow></mrow><annotation encoding="application/x-tex">
\text{LightF} = 1 - \exp\left( -k_{\text{light}} \cdot \frac{\text{PAR}}{L_{\text{max}}} \right)
</annotation></semantics></math></p>
<p>An asymptotic saturation function modeling the effect of
photosynthetically active radiation (PAR) on growth. LightF approaches 1
as PAR increases.</p>
<hr>
</div>
<div class="section level5">
<h5 id="vapor-pressure-deficit-limitation-vpdef">üí® Vapor Pressure Deficit Limitation (VPDeF)<a class="anchor" aria-label="anchor" href="#vapor-pressure-deficit-limitation-vpdef"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">VPDeF</mtext><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mtext mathvariant="normal">VPD</mtext><mo>&lt;</mo><mtext mathvariant="normal">VPD</mtext><mtext mathvariant="normal">min</mtext><mspace width="0.222em"></mspace><mfrac><mn>1</mn><mrow><mn>1</mn><mo>+</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>k</mi><mtext mathvariant="normal">VPD</mtext><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mtext mathvariant="normal">VPD</mtext><mo>‚àí</mo><mfrac><mrow><mtext mathvariant="normal">VPD</mtext><mtext mathvariant="normal">max</mtext><mo>+</mo><mtext mathvariant="normal">VPD</mtext><mtext mathvariant="normal">min</mtext></mrow><mn>2</mn></mfrac><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex"> \text{VPDeF} = \begin{cases} 1 &amp; \text{if } \text{VPD} &lt; \text{VPD}{\text{min}} \ \frac{1}{1 + \exp\left( k{\text{VPD}} \cdot \left( \text{VPD} - \frac{ \text{VPD}{\text{max}} + \text{VPD}{\text{min}} }{2} \right) \right)} &amp; \text{otherwise} \end{cases} </annotation></semantics></math></p>
<p>This function represents stress induced by high evaporative demand.
Limitation increases as VPD surpasses VPDmin.</p>
<hr>
</div>
<div class="section level5">
<h5 id="drought-stress-indicator-droughtf">üíß Drought Stress Indicator (DroughtF)<a class="anchor" aria-label="anchor" href="#drought-stress-indicator-droughtf"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">DroughtF</mtext><mo>=</mo><mfrac><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><msub><mi>T</mi><mi>c</mi></msub><mo>‚àí</mo><mtext mathvariant="normal">Prec</mtext><mo stretchy="true" form="postfix">)</mo></mrow><mrow><mo stretchy="true" form="prefix">(</mo><mi>E</mi><msub><mi>T</mi><mi>c</mi></msub><mo>+</mo><mtext mathvariant="normal">Prec</mtext><mo stretchy="true" form="postfix">)</mo></mrow></mfrac><mo>‚ãÖ</mo><mfrac><mn>1</mn><mn>2</mn></mfrac><mo>+</mo><mfrac><mn>1</mn><mn>2</mn></mfrac></mrow><annotation encoding="application/x-tex">
\text{DroughtF} = \frac{(ET_c - \text{Prec})}{(ET_c + \text{Prec})} \cdot \frac{1}{2} + \frac{1}{2}
</annotation></semantics></math></p>
<p>A normalized aridity index based on crop transpiration (ETc) and
precipitation (Prec). Values near 1 indicate water stress.</p>
<hr>
<div class="section level6">
<h6 id="crop-coefficient-kc">üå± Crop Coefficient (Kc)<a class="anchor" aria-label="anchor" href="#crop-coefficient-kc"></a>
</h6>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><msub><mi>K</mi><mi>c</mi></msub><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>K</mi><mtext mathvariant="normal">max</mtext></msub></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>B</mi><mi>B</mi><mi>C</mi><mi>H</mi><mo>&gt;</mo><mn>65</mn></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><msub><mi>K</mi><mtext mathvariant="normal">ini</mtext></msub><mo>+</mo><mrow><mo stretchy="true" form="prefix">(</mo><msub><mi>K</mi><mtext mathvariant="normal">full</mtext></msub><mo>‚àí</mo><msub><mi>K</mi><mtext mathvariant="normal">ini</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo>‚ãÖ</mo><mfrac><mrow><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mn>0.1</mn><mo>‚ãÖ</mo><mi>B</mi><mi>B</mi><mi>C</mi><mi>H</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mn>1</mn><mo>‚àí</mo><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><mn>0.1</mn><mo>‚ãÖ</mo><mn>65</mn><mo stretchy="true" form="postfix">)</mo></mrow></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
K_c =
\begin{cases}
K_{\text{max}} &amp; \text{if } BBCH &gt; 65 \\
K_{\text{ini}} + (K_{\text{full}} - K_{\text{ini}}) \cdot \frac{1 - \exp(-0.1 \cdot BBCH)}{1 - \exp(-0.1 \cdot 65)} &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>Describes the development of canopy cover through phenology using
BBCH scale. Used to scale ET‚ÇÄ into ETc.</p>
<hr>
</div>
</div>
<div class="section level5">
<h5 id="wind-induced-stress-windf">üå¨Ô∏è Wind-Induced Stress (WindF)<a class="anchor" aria-label="anchor" href="#wind-induced-stress-windf"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">WindF</mtext><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>W</mi><mo>&lt;</mo><msub><mi>W</mi><mtext mathvariant="normal">min</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mo>exp</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>‚àí</mi><msub><mi>k</mi><mtext mathvariant="normal">wind</mtext></msub><mo>‚ãÖ</mo><mrow><mo stretchy="true" form="prefix">(</mo><mi>W</mi><mo>‚àí</mo><msub><mi>W</mi><mtext mathvariant="normal">min</mtext></msub><mo stretchy="true" form="postfix">)</mo></mrow><mo stretchy="true" form="postfix">)</mo></mrow></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{WindF} =
\begin{cases}
1 &amp; \text{if } W &lt; W_{\text{min}} \\
\exp(-k_{\text{wind}} \cdot (W - W_{\text{min}})) &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>Models the exponential decline in physiological performance under
high wind speeds. Applied across the phenological cycle.</p>
<hr>
</div>
<div class="section level5">
<h5 id="disease-favorability-diseasef">ü¶† Disease Favorability (DiseaseF)<a class="anchor" aria-label="anchor" href="#disease-favorability-diseasef"></a>
</h5>
<p><math display="block" xmlns="http://www.w3.org/1998/Math/MathML"><semantics><mrow><mtext mathvariant="normal">DiseaseF</mtext><mo>=</mo><mrow><mo stretchy="true" form="prefix">{</mo><mtable><mtr><mtd columnalign="left" style="text-align: left"><mn>1</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>W</mi><mi>D</mi><mo>&gt;</mo><mi>W</mi><msub><mi>D</mi><mtext mathvariant="normal">opt</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mn>0</mn></mtd><mtd columnalign="left" style="text-align: left"><mrow><mtext mathvariant="normal">if </mtext><mspace width="0.333em"></mspace></mrow><mi>W</mi><mi>D</mi><mo>&lt;</mo><mi>W</mi><msub><mi>D</mi><mtext mathvariant="normal">min</mtext></msub></mtd></mtr><mtr><mtd columnalign="left" style="text-align: left"><mfrac><mrow><mi>W</mi><msub><mi>D</mi><mtext mathvariant="normal">min</mtext></msub><mi>/</mi><mi>f</mi><mrow><mo stretchy="true" form="prefix">(</mo><mi>T</mi><mo stretchy="true" form="postfix">)</mo></mrow></mrow><mrow><mi>W</mi><msub><mi>D</mi><mtext mathvariant="normal">opt</mtext></msub></mrow></mfrac></mtd><mtd columnalign="left" style="text-align: left"><mtext mathvariant="normal">otherwise</mtext></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">
\text{DiseaseF} =
\begin{cases}
1 &amp; \text{if } WD &gt; WD_{\text{opt}} \\
0 &amp; \text{if } WD &lt; WD_{\text{min}} \\
\frac{WD_{\text{min}} / f(T)}{WD_{\text{opt}}} &amp; \text{otherwise}
\end{cases}
</annotation></semantics></math></p>
<p>Evaluates the infection risk of <strong>P. viticola</strong> based on
temperature suitability and wetness duration. Uses the same temperature
response as TempF.</p>
<hr>
</div>
</div>
</div>
<div class="section level3">
<h3 id="phenology-based-binning-correlation-analysis">2. Phenology-Based Binning &amp; Correlation Analysis<a class="anchor" aria-label="anchor" href="#phenology-based-binning-correlation-analysis"></a>
</h3>
<p>Each eco-physiological signal is:</p>
<ol style="list-style-type: decimal">
<li>Smoothed using a rolling mean (default: 3 days)</li>
<li>Discretized along a 0‚Äì400 phenological timeline (default: 1-bin
resolution)</li>
</ol>
<p>This alignment captures biological stages rather than calendar dates.
Pairwise correlations among signals are computed to detect
multicollinearity. Signals with r &gt; 0.9 are screened, and the least
redundant signal is retained.</p>
<p>Each bin‚Äôs correlation with target traits (e.g., yield, brix) is
evaluated using Pearson‚Äôs r and associated p-value. Trait values are
min‚Äìmax normalized within each site‚Äìvariety combination to [‚Äì1, 1],
generating a correlation profile across the phenological cycle.</p>
<hr>
</div>
<div class="section level3">
<h3 id="sigmoid-scaling-weighting-and-signal-aggregation">3. Sigmoid Scaling, Weighting, and Signal Aggregation<a class="anchor" aria-label="anchor" href="#sigmoid-scaling-weighting-and-signal-aggregation"></a>
</h3>
<p>Smoothed signals are normalized using a sigmoid transformation:</p>
<pre><code>scaled_i = 1 / (1 + exp(-10 * (f_i - fÃÉ) / ((f_90 - f_10) / 2)))</code></pre>
<ul>
<li>
<code>f_i</code>: Signal value in year <em>i</em>
</li>
<li>
<code>fÃÉ</code>: Median value across years for that bin</li>
<li>
<code>f_10</code>, <code>f_90</code>: 10th and 90th percentiles</li>
</ul>
<p>Then, signals are weighted by correlation strength:</p>
<pre><code><span><span class="va">weighted_i</span> <span class="op">=</span> <span class="va">scaled_i</span> <span class="op">*</span> <span class="va">r</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="va">p</span><span class="op">)</span></span></code></pre>
<p>Finally, weighted signals are summed across bins to produce
cumulative PhenoMeNals:</p>
<pre><code>PhenoMeNal_{i,j} = Œ£ weighted_{i,j}(bin) for bin = 1 to 400</code></pre>
<hr>
</div>
<div class="section level3">
<h3 id="model-selection-and-trait-prediction">4. Model Selection and Trait Prediction<a class="anchor" aria-label="anchor" href="#model-selection-and-trait-prediction"></a>
</h3>
<p>A stepwise variable selection using AIC (via <code>stepAIC</code>
from the <code>MASS</code> package) identifies the most informative
subset of PhenoMeNals per bin (max predictors: 4). For each bin:</p>
<ul>
<li>A multiple linear regression model is trained using selected
PhenoMeNals</li>
<li>Leave-One-Out Cross-Validation (LOOCV) is applied
(<code>caret</code> package)</li>
<li>Metrics computed include R¬≤, RMSE, MAE, and nMBE</li>
</ul>
<p>Predictor importance is assessed using the LMG method (Groemping,
2006), which decomposes R¬≤ by averaging contributions across all
possible predictor orderings. Diagnostic plots include
prediction‚Äìobservation correlation, residual analysis, and
phenology‚Äìprediction alignment.</p>
<hr>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Simone Bregaglio, Sofia Bajocco.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.9000.</p>
</div>

    </footer>
</div>





  </body>
</html>
